<!DOCTYPE html>
<html lang="en">

<head>
    <title>LsCo </title>
    <link rel='icon' href='https://cdn.7tv.app/emote/623a1a28fbedd5baeb4183e4/2x' />

    <meta name="author" content="LsCo">
    <meta name="description" content="Twitch Moderator & Developer">

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=0.7">
</head>

<body>
    <header>
        <div class="home_icon">
            <img src="https://static-cdn.jtvnw.net/jtv_user_pictures/05cfe869-ea3e-47cb-827b-2eec01e5d419-profile_image-300x300.png"
                alt="Icon">
        </div>
    </header>
    <main>
        <div class="title">
            <div class="text">
                About me
            </div>
        </div>
        <div class="front">
            <div class="line">
                <table>
                    <tr>
                        <td>
                            <div class="image-area">
                                <div class="image">
                                    <img src="https://static-cdn.jtvnw.net/emoticons/v2/81274/default/dark/2.0"
                                        alt="VoHiYo">
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="text">
                                Twitch Moderator & Developer
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="front">
            <div class="line">
                <table>
                    <tr>
                        <td>
                            <div class="image-area">
                                <div class="image">
                                    <img src="https://cdn.7tv.app/emote/623a1a28fbedd5baeb4183e4/2x" alt="HACKERDANK">
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="text">
                                Moderation & development since August 2021
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="title">
            <div class="text">
                Tools
            </div>
        </div>
        <div class="front">
            <div class="line">
                <table>
                    <tr>
                        <td>
                            <div class="image-area">
                                <div class="image">
                                    <img src="./img/chatty.png" alt="Chatty">
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="text">
                                <a href="https://chatty.github.io" target="_blank" rel="noopener noreferrer">Chatty</a>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="front">
            <div class="line">
                <table>
                    <tr>
                        <td>
                            <div class="image-area">
                                <div class="image">
                                    <img src="./img/chatterino.png" alt="Chatterino">
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="text">
                                <a href="https://github.com/SevenTV/chatterino7/releases/tag/nightly-build"
                                    target="_blank" rel="noopener noreferrer">Chatterino-Nightly</a>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="front">
            <div class="line">
                <table>
                    <tr>
                        <td>
                            <div class="image-area">
                                <div class="image">
                                    <img src="./img/firefox-developer.png" alt="Firefox Browser">
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="text">
                                <a href="https://www.mozilla.org/en-US/firefox/developer/" target="_blank"
                                    rel="noopener noreferrer">Firefox Browser Developer</a>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="title">
            <div class="text">
                <a href="https://modlookup.3v.fi/u/lsco" target="_blank" rel="noopener noreferrer">ModLookUp</a>
            </div>
        </div>
        <div class="front">
            <div id="modlookup">
                <progress></progress>
            </div>
        </div>
        <div class="title">
            <div class="text">
                Streamer where I moderate
            </div>
        </div>
        <div class="front">
            <div id="modChannels">
                <progress></progress>
            </div>
        </div>
        <div class="title">
            <div class="text">
                Chat
            </div>
        </div>
        <div class="front">
            <div id="chat">
            </div>
        </div>
        <div class="title">
            <div class="text">
                Social Media
            </div>
        </div>
        <div class="front">
            <div class="media">
                <a href="https://github.com/devLsCo/" target="_blank" rel="noopener noreferrer">
                    <img src="./img/github.png">
                </a>
                <a href="https://www.twitch.tv/LsCo/" target="_blank" rel="noopener noreferrer">
                    <img src="./img/twitch.png">
                </a>
                <a href="https://www.twitter.com/infoLsCo" target="_blank" rel="noopener noreferrer">
                    <img src="./img/twitter.png">
                </a>
            </div>
        </div>
    </main>
</body>

<script>
    const modlookup = document.getElementById("modlookup");
    const modlookupChannels = document.getElementById("modlookupChannels");

    const channelName = "lsco";
    const minChannelFollowers = 5000;

    window.onload = ModLookUp(), ModChannels();

    function format(number) {
        return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }

    async function ModLookUp() {
        await fetch(`https://modlookup.3v.fi/api/user-totals/${channelName}`).then(response => response.json()).then(data => {
            modlookup.innerHTML = `<div class="modlookup"><table><tr><td>Follow total: <highlight>${format(data.follows)}</highlight></td><td>Views total: <highlight>${format(data.views)}</highlight></td></tr><tr><td>Channels: <highlight>${format(data.total)}</highlight></td><td>Partners: <highlight>${format(data.partners)}</highlight></td></tr></table></div>`;
        }).catch(e => {
            console.error(e);
            modlookup.innerHTML = `<div><text>Error: <text style="color: #FF0000;">${e.message}</text></div>`;
        });
    }

    async function ModChannels() {
        await fetch(`https://modlookup.3v.fi/api/user-v3/${channelName}?limit=5000`).then(response => response.json()).then(data => {
            modChannels.innerHTML = "";
            let channelsList = `?login=${channelName}`;
            for (const channel of data.channels.map(res => res)) {
                if (channel.followers > minChannelFollowers) {
                    channelsList += `,${channel.name}`;
                }
            }
            fetch(`https://api.ivr.fi/v2/twitch/user${decodeURIComponent(channelsList)}`).then(response => response.json()).then(request => {
                if (!request.error) {
                    const newData = request.sort((x, y) => Number(y.followers) - Number(x.followers));
                    for (const channel of newData) {
                        if (channel.login && channel.login !== channelName) {
                            modChannels.innerHTML += `<div class="line"><table><tr><td><div class="image-area"><div class="image"><img class="logo" src="${channel.logo.replace("600x600", "300x300")}" alt="${channel.login}"></div></div></td><td><div class="text"><a style="color: ${channel.chatColor ? channel.chatColor : "#FFF"};" href="https://www.twitch.tv/${encodeURIComponent(channel.login)}/" target="_blank" rel="noopener noreferrer">${channel.displayName ? channel.displayName : channel.login}</a></div></td><div class="followers">~${format(channel.followers)}</div></tr></table>${channel.stream ? `<br><table><tr><td><div class="text"><a class="game" href="https://www.twitch.tv/directory/game/${encodeURI(channel.stream.game.displayName)}/" target="_blank" rel="noopener noreferrer">${channel.stream.game.displayName}</a></div></td><td><div class="text margin">${format(channel.stream.viewersCount)}</div></td><td><div class="text">${channel.stream.title}</div></td></tr></table>` : ""}</div>`;
                        }
                    }
                } else {
                    return modChannels.innerHTML = `<div><text>Error: <text style="color: #FF0000;">${request.message ? request.message : request.error.message}</text></div>`;
                }
            }).catch(e => {
                console.error(e);
                return modChannels.innerHTML = `<div><text>Error: <text style="color: #FF0000;">${e.message}</text></div>`;
            });
        }).catch(e => {
            console.error(e);
            return modChannels.innerHTML = `<div><text>Error: <text style="color: #FF0000;">${e.message}</text></div>`;
        });
    }

    const chat = document.getElementById("chat");

    let ws = new WebSocket("wss://irc-ws.chat.twitch.tv/");

    ws.onopen = function () {
        this.send("CAP REQ :twitch.tv/tags twitch.tv/commands");
        this.send("PASS SCHMOOPIIE");
        this.send("NICK justinfan123");
        this.send("JOIN #lsco");
        setInterval(() => {
            this.send("PING");
        }, 25000);
    };

    let SevenTV = new Map();
    let BetterTTV = new Map();
    let FFZ = new Map();

    let GlobalSevenTV = new Map();
    let GlobalBetterTTV = new Map();
    let GlobalFFZ = new Map();
    (async () => {
        await fetch(`https://api.7tv.app/v2/users/lsco/emotes`).then(response => response.json()).then(data => {
            SevenTV.set("i", data)
        })
        await fetch(`https://api.betterttv.net/3/cached/users/twitch/617309984`).then(response => response.json()).then(data => {
            BetterTTV.set("ii", data)
        })
        await fetch(`https://api.frankerfacez.com/v1/room/lsco`).then(response => response.json()).then(data => {
            FFZ.set("iii", data)
        })
        // global Emotes
        await fetch(`https://7tv.io/v3/emote-sets/global`).then(response => response.json()).then(data => {
            GlobalSevenTV.set("iiii", data)
        })

        await fetch(`https://api.betterttv.net/3/cached/emotes/global`).then(response => response.json()).then(data => {
            GlobalBetterTTV.set("iiiii", data)
        })

        await fetch(`https://api.frankerfacez.com/v1/set/global`).then(response => response.json()).then(data => {
            GlobalFFZ.set("iiiiii", data)
        })

        ws.onmessage = async function (event) {
            if (event.data.includes("PRIVMSG")) {
                let date = event.data.split("tmi-sent-ts=")[1].split(";")[0]
                let color = event.data.split("color=")[1].split(";")[0]
                let bedges = event.data.split("badges=")[1].split(";")[0]
                let displayName = event.data.split("display-name=")[1].split(";")[0]
                let message = `${event.data.split("PRIVMSG #lsco :")[1]}`;


                for (const i of SevenTV.get("i")) {
                    message = message.replace(new RegExp(`\\b${i.name}\\b`, "gm"), ` <img src="https://cdn.7tv.app/emote/${i.id}/1x.webp"> `);
                }

                for (const i of BetterTTV.get("ii").sharedEmotes) {
                    message = message.replace(new RegExp(`\\b${i.code}\\b`, "gm"), ` <img src="https://cdn.betterttv.net/emote/${i.id}/1x"> `);
                }

                for (const i of FFZ.get("iii").sets["1114561"].emoticons) {
                    message = message.replace(new RegExp(`\\b${i.name}\\b`, "gm"), ` <img src="https://cdn.frankerfacez.com/emoticon/${i.id}/1"> `);
                }

                for (const i of GlobalSevenTV.get("iiii").emotes) {
                    message = message.replace(new RegExp(`\\b${i.name}\\b`, "gm"), ` <img src="https://cdn.7tv.app/emote/${i.id}/1x.webp" `);
                }

                for (const i of GlobalBetterTTV.get("iiiii")) {
                    message = message.replace(new RegExp(`\\b${i.code}\\b`, "gm"), ` <img src="https://cdn.betterttv.net/emote/${i.id}/1x"> `);
                }

                for (const i of GlobalFFZ.get("iiiiii").sets["3"].emoticons) {
                    message = message.replace(new RegExp(`\\b${i.name}\\b`, "gm"), ` <img src="https://cdn.frankerfacez.com/emoticon/${i.id}/1"> `);
                }
                chat.innerHTML +=
                    `
            <div>
                <div class="inner-chat-message">
                    <div class="inner-chat-message date">
                        ${new Date(new Date(new Date()).setHours(new Date().getHours() + 2)).toISOString().replace("T", " ").replace("Z", "").split(".")[0].split(" ")[1]}
                    </div>
                    <div  style="color: ${color};" class="inner-chat-message user">
                        ${displayName}:
                    </div>
                    <div class="inner-chat-message message">
                        ${message}
                    </div>
                </div>
                <p></p>
            </div>
            `;
            }
            // console.log(`[Response]: ${event.data}`)
        };

    })().catch(((error) => {
        console.log(error)
    }))



    ws.onerror = function (error) {
        console.log(`[Error]: ${error}`)
    };
</script>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Lato:wght@300;400&display=swap');

    ::-webkit-scrollbar {
        width: 10px;
    }

    ::-webkit-scrollbar-track {
        background: #1d1e20;
    }

    ::-webkit-scrollbar-thumb {
        background: #1d1e20;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: #1d1e20;
    }

    * {
        vertical-align: middle;
        scroll-behavior: smooth;
        overflow-y: visible;
        scrollbar-width: thin;
    }


    body {
        user-select: none;
        color: #ffffff;
        background-color: rgb(18, 18, 18);
        animation: color 3s infinite;
        font-family: 'Lato', sans-serif;
    }

    header {
        text-align: center;
        margin-top: 10px;
    }

    header div.home_icon img {
        width: 120px;
        height: 120px;
        border-radius: 20px;
        margin-left: 6%;
        margin-top: 1%;
    }

    main {
        margin-left: 6%;
        margin-top: 2%;
    }

    main div.text {
        align-items: center;
        vertical-align: baseline;
        width: 100%;
    }

    main div.title {
        font-size: 25px;
        font-weight: bold;
        margin: 26px 0px 26px 0px;
    }

    main div.line {
        display: block;
        background-color: #1c20225f;
        border-radius: 10px;
        padding: 10px;
        margin-right: 20%;
        margin-top: 10px;
    }

    a,
    highlight {
        display: inline;
        color: #15a3a5;
        text-decoration: none;
        vertical-align: unset;
    }

    main div.media a img {
        padding: 12px;
        margin: 16px;
    }

    main div.media a img:hover {
        background-color: #3c3c3c88;
        border-radius: 10px;
        transform: scale(1.3);
    }

    main div.image img {
        width: 30px;
    }

    main div a.game {
        animation: animation 2s infinite;
        color: #15a3a5;
    }

    main div.rainbow {
        animation: animation 2s infinite;
        color: #15a3a5;
    }

    @keyframes animation {

        10% {
            color: #ff0000;
        }

        20% {
            color: #f69f09;
        }

        30% {
            color: #ffff17de;
        }

        40% {
            color: #37f222;
        }

        50% {
            color: #009dff;
        }

        60% {
            color: #a028f6;
        }

        70% {
            color: #5f06a7;
        }

    }

    main div.image-area div.image .logo {
        border-radius: 25px;
        width: 30px;
    }

    main div.line div.followers {
        font-style: italic;
        float: right;
        color: #009dff;
    }

    main div.modlookup table {
        width: 400px;
        margin-left: 15px;
    }

    main div.front {
        margin-left: 15px;
    }

    main div .image-area {
        display: inline-block;
        width: 40px;
        height: 27px;
        margin-left: 15px;
    }

    main div.margin {
        margin-left: 10px;
        margin-right: 10px;
    }

    main div.inner-chat-message {
        display: inline;
        text-decoration: none;
        vertical-align: unset;
    }

    main div.inner-chat-message.user {
        color: #06456c;
    }
</style>

</html>